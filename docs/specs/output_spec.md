# ะกะฟะตัะธัะธะบะฐัะธั ัะพัะผะฐัะพะฒ ะฒัะฒะพะดะฐ โ v2.1

**ะะตััะธั:** 2.1  
**ะะฐัะฐ:** 18 ะพะบััะฑัั 2025  
**ะกัะฐััั:** ะงะตัะฝะพะฒะธะบ

---

## ะะฑะทะพั

ะะฐััะธัะตะฝะธะต ัะธััะตะผั ThermoSystemV2 ะดะปั ะฟะพะดะดะตัะถะบะธ ะดะฒัั ัะธะฟะพะฒ ะทะฐะฟัะพัะพะฒ ั ัะฐะทะปะธัะฝัะผะธ ัะพัะผะฐัะฐะผะธ ะฒัะฒะพะดะฐ:

1. **ะขะฐะฑะปะธัะฝัะต ะดะฐะฝะฝัะต ะฒะตัะตััะฒ** โ ะธะฝัะพัะผะฐัะธั ะพ ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฒะพะนััะฒะฐั ะพัะดะตะปัะฝัั ัะพะตะดะธะฝะตะฝะธะน
2. **ะะฐัััั ัะตะฐะบัะธะน** โ ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะน ะฐะฝะฐะปะธะท ัะธะผะธัะตัะบะธั ัะตะฐะบัะธะน

---

## 1. ะะปะฐััะธัะธะบะฐัะธั ะทะฐะฟัะพัะพะฒ

### ะะฟัะตะดะตะปะตะฝะธะต ัะธะฟะฐ ะทะฐะฟัะพัะฐ

**ะะตัะพะด:** ThermodynamicAgent ะพะฟัะตะดะตะปัะตั ัะธะฟ ะทะฐะฟัะพัะฐ ะฟัะธ ะธะทะฒะปะตัะตะฝะธะธ ะฟะฐัะฐะผะตััะพะฒ.

**ะขะธะฟั ะทะฐะฟัะพัะพะฒ:**

- `compound_data` โ ะทะฐะฟัะพั ะดะฐะฝะฝัั ะฟะพ ะฒะตัะตััะฒะฐะผ (ะฑะตะท ัะตะฐะบัะธะธ)
- `reaction_calculation` โ ัะฐัััั ัะตัะผะพะดะธะฝะฐะผะธะบะธ ัะตะฐะบัะธะธ

**ะัะธัะตัะธะธ ะบะปะฐััะธัะธะบะฐัะธะธ:**

| ะัะธัะตัะธะน           | `compound_data`                                     | `reaction_calculation`                            |
| ------------------ | --------------------------------------------------- | ------------------------------------------------- |
| ะะฐะปะธัะธะต ัะตะฐะบัะธะธ    | ะะตั (โ, =, โ ะพััััััะฒัะตั)                           | ะะฐ (ะฟัะธัััััะฒัะตั โ, =, โ)                         |
| ะะพะปะธัะตััะฒะพ ะฒะตัะตััะฒ | 1 ะฒะตัะตััะฒะพ                                          | 2+ ะฒะตัะตััะฒะฐ ั ัะตะฐะบัะธะตะน                            |
| ะะปััะตะฒัะต ัะปะพะฒะฐ     | "ะดะฐะฝะฝัะต", "ัะฒะพะนััะฒะฐ", "ัะฐะฑะปะธัะฐ ะดะปั", "ะธะฝัะพัะผะฐัะธั ะพ" | "ัะตะฐะบัะธั", "ัะฐัััะธัะฐะน", "ะฑะฐะปะฐะฝั", "ัะตัะผะพะดะธะฝะฐะผะธะบะฐ" |

---

## 2. ะคะพัะผะฐั ะฒัะฒะพะดะฐ: ะขะฐะฑะปะธัะฝัะต ะดะฐะฝะฝัะต ะฒะตัะตััะฒ

### ะกัะตะฝะฐัะธะน ะธัะฟะพะปัะทะพะฒะฐะฝะธั

ะะพะปัะทะพะฒะฐัะตะปั: "ะะฐะน ัะฐะฑะปะธัั ะดะปั H2O ะฟัะธ 300-600K"  
ะะพะปัะทะพะฒะฐัะตะปั: "ะกะฒะพะนััะฒะฐ WCl6 ั ัะฐะณะพะผ 50 ะณัะฐะดััะพะฒ"

### ะกัััะบัััะฐ ะฒัะฒะพะดะฐ

```
๐ ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ะดะฐะฝะฝัะต: H2O

ะะฐะทะพะฒัะต ัะฒะพะนััะฒะฐ:
  ะคะพัะผัะปะฐ: H2O
  ะะฐะทะฒะฐะฝะธะต: Water (ะฒะพะดะฐ)
  ะคะฐะทะฐ: g (gas)
  T_ะดะธะฐะฟะฐะทะพะฝ: 298-1500 K
  Tmelt: 273.15 K
  Tboil: 373.15 K
  H298: -241.826 ะบะะถ/ะผะพะปั
  S298: 188.835 ะะถ/(ะผะพะปัยทK)
  Cp_ะบะพัััะธัะธะตะฝัั: f1=30.092, f2=6.832, f3=6.793, f4=-2.534, f5=0.082, f6=-0.0
  ะะฐะดัะถะฝะพััั: A (ะฒััะพะบะฐั)

ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ัะฒะพะนััะฒะฐ ะฟะพ ัะตะผะฟะตัะฐัััะต:
โโโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโโโโโโโ
โ T(K) โ  Cp        โ    H       โ    S       โ    G       โ
โ      โ ะะถ/(ะผะพะปัยทK)โ  ะบะะถ/ะผะพะปั  โ ะะถ/(ะผะพะปัยทK)โ  ะบะะถ/ะผะพะปั  โ
โโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโค
โ  300 โ   33.58    โ  -241.76   โ   189.04   โ  -298.47   โ
โ  400 โ   35.22    โ  -238.36   โ   198.79   โ  -317.88   โ
โ  500 โ   36.32    โ  -234.81   โ   206.53   โ  -338.08   โ
โ  600 โ   37.15    โ  -231.18   โ   213.05   โ  -359.01   โ
โโโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโโโโ

ะัะธะผะตัะฐะฝะธั:
  - ะจะฐะณ ะฟะพ ัะตะผะฟะตัะฐัััะต: 100 K (ะฟะพ ัะผะพะปัะฐะฝะธั)
  - ะัะต ะทะฝะฐัะตะฝะธั ัะฐัััะธัะฐะฝั ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ััะฐะฒะฝะตะฝะธะน ะจะพะผะตะนัะฐ
```

**ะะฐัะฐะผะตััั ัะฐะณะฐ:**
- ะะพ ัะผะพะปัะฐะฝะธั: 100K
- ะะธะฐะฟะฐะทะพะฝ: 25-250K (ะธะทะฒะปะตะบะฐะตััั ะธะท ะทะฐะฟัะพัะฐ ะฟะพะปัะทะพะฒะฐัะตะปั)

---

## 3. ะคะพัะผะฐั ะฒัะฒะพะดะฐ: ะะฐัััั ัะตะฐะบัะธะน

### ะกัะตะฝะฐัะธะน ะธัะฟะพะปัะทะพะฒะฐะฝะธั

ะะพะปัะทะพะฒะฐัะตะปั: "2 W + 4 Cl2 + O2 โ 2 WOCl4 ะฟัะธ 600-900K"  
ะะพะปัะทะพะฒะฐัะตะปั: "ะะฐัััะธัะฐะน ัะตัะผะพะดะธะฝะฐะผะธะบั ัะปะพัะธัะพะฒะฐะฝะธั ะฒะพะปัััะฐะผะฐ"

### ะกัััะบัััะฐ ะฒัะฒะพะดะฐ

```
โ๏ธ ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะน ัะฐัััั ัะตะฐะบัะธะธ

ะฃัะฐะฒะฝะตะฝะธะต: 2 W(s) + 4 Clโ(g) + Oโ(g) โ 2 WOClโ(g)
ะขะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ: 600-900 K

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะะตัะพะด ัะฐััััะฐ:

1. ะญะฝัะฐะปัะฟะธั ัะตะฐะบัะธะธ: ฮHยฐ(T) = ฮฃHยฐ_ะฟัะพะดัะบัั - ฮฃHยฐ_ัะตะฐะณะตะฝัั
2. ะญะฝััะพะฟะธั ัะตะฐะบัะธะธ: ฮSยฐ(T) = ฮฃSยฐ_ะฟัะพะดัะบัั - ฮฃSยฐ_ัะตะฐะณะตะฝัั  
3. ะญะฝะตัะณะธั ะะธะฑะฑัะฐ: ฮGยฐ(T) = ฮHยฐ(T) - TยทฮSยฐ(T)

ะะดะต:
  Hยฐ(T) = Hยฐโโโ + โซโโโแต Cp(T)dT
  Sยฐ(T) = Sยฐโโโ + โซโโโแต [Cp(T)/T]dT
  Cp(T) = fโ + fโT/1000 + fโTโปยฒยท10โต + fโTยฒ/10โถ + fโTโปยณยท10ยณ + fโTยณยท10โปโน

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ะดะฐะฝะฝัะต ะฒะตัะตััะฒ:

W(s) โ Tungsten
  ะคะฐะทะฐ: s | T_ะฟัะธะผะตะฝะธะผะพััะธ: 450-2500 K
  H298: 0.0 ะบะะถ/ะผะพะปั | S298: 32.64 ะะถ/(ะผะพะปัยทK)
  Cp: [23.957, 3.868, 0.0, -0.761, 0.0, 0.0]

Clโ(g) โ Chlorine  
  ะคะฐะทะฐ: g | T_ะฟัะธะผะตะฝะธะผะพััะธ: 298-1500 K
  H298: 0.0 ะบะะถ/ะผะพะปั | S298: 223.08 ะะถ/(ะผะพะปัยทK)
  Cp: [33.907, 0.892, -7.615, 0.229, 0.023, 0.0]

Oโ(g) โ Oxygen
  ะคะฐะทะฐ: g | T_ะฟัะธะผะตะฝะธะผะพััะธ: 298-700 K
  H298: 0.0 ะบะะถ/ะผะพะปั | S298: 205.15 ะะถ/(ะผะพะปัยทK)
  Cp: [29.659, 6.137, -11.881, 0.794, 0.674, 0.0]

WOClโ(g) โ Tungsten oxychloride
  ะคะฐะทะฐ: g | T_ะฟัะธะผะตะฝะธะผะพััะธ: 298-600 K
  H298: -681.6 ะบะะถ/ะผะพะปั | S298: 378.2 ะะถ/(ะผะพะปัยทK)
  Cp: [87.445, 13.821, 0.0, -2.156, 0.0, 0.0]

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะะตะทัะปััะฐัั ัะฐััััะฐ (ะฝะฐ ะผะพะปั ะฟัะพะดัะบัะฐ):

600 K: ฮHยฐ = -523.45 ะบะะถ/ะผะพะปั | ฮSยฐ = -186.23 ะะถ/(ะยทะผะพะปั) | ฮGยฐ = -411.71 ะบะะถ/ะผะพะปั
700 K: ฮHยฐ = -521.18 ะบะะถ/ะผะพะปั | ฮSยฐ = -184.67 ะะถ/(ะยทะผะพะปั) | ฮGยฐ = -391.91 ะบะะถ/ะผะพะปั
800 K: ฮHยฐ = -518.92 ะบะะถ/ะผะพะปั | ฮSยฐ = -183.24 ะะถ/(ะยทะผะพะปั) | ฮGยฐ = -372.33 ะบะะถ/ะผะพะปั
900 K: ฮHยฐ = -516.71 ะบะะถ/ะผะพะปั | ฮSยฐ = -181.95 ะะถ/(ะยทะผะพะปั) | ฮGยฐ = -352.96 ะบะะถ/ะผะพะปั

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ ะะตะฐะบัะธั ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธ ะฒัะณะพะดะฝะฐ ะฒะพ ะฒััะผ ะดะธะฐะฟะฐะทะพะฝะต (ฮGยฐ < 0)
```

**ะะปััะตะฒัะต ะพัะพะฑะตะฝะฝะพััะธ:**
- ะะฟะธัะฐะฝะธะต ะผะตัะพะดะฐ ัะฐััััะฐ ั ะผะฐัะตะผะฐัะธัะตัะบะธะผะธ ัะพัะผัะปะฐะผะธ
- ะัะฐัะบะฐั ัะฐะฑะปะธัะฝะฐั ัะฒะพะดะบะฐ ะฟะพ ะฒะตัะตััะฒะฐะผ (ะบะพะผะฟะฐะบัะฝัะน ัะพัะผะฐั)
- ะะตะทัะปััะฐัั ะฒ ัะพัะผะฐัะต "ัะตะผะฟะตัะฐัััะฐ: ัะฒะพะนััะฒะฐ"
- ะัะฒะพะด ะฒัะตั ัะฒะพะนััะฒ: ฮH, ฮS, ฮG

---

## 4. ะะทะผะตะฝะตะฝะธั ะฒ ะฐััะธัะตะบัััะต

### 4.1. ExtractedReactionParameters (ัะฐััะธัะตะฝะธะต)

ะะพะฑะฐะฒะธัั ะฝะพะฒัะต ะฟะพะปั:

```python
class ExtractedReactionParameters(BaseModel):
    # ะกััะตััะฒัััะธะต ะฟะพะปั...
    
    # ะะพะฒัะต ะฟะพะปั:
    query_type: Literal["compound_data", "reaction_calculation"]
    temperature_step_k: int = 100  # 25-250, ะฟะพ ัะผะพะปัะฐะฝะธั 100
```

---

## 8. ะะตัะฐะปะธ ัะตะฐะปะธะทะฐัะธะธ: ะัะพะผะฟั ะธ ะบะปะฐััะธัะธะบะฐัะธั

### 8.1. ะะฑะฝะพะฒะปะตะฝะธะต THERMODYNAMIC_EXTRACTION_PROMPT

**ะะตััะพะฟะพะปะพะถะตะฝะธะต:** `src/thermo_agents/prompts.py`

**ะะทะผะตะฝะตะฝะธั ะฒ ะฟัะพะผะฟัะต:**

```python
THERMODYNAMIC_EXTRACTION_PROMPT = """
ะขั โ ัะบัะฟะตัั ะฟะพ ัะตัะผะพะดะธะฝะฐะผะธะบะต ะธ ัะธะผะธะธ. ะขะฒะพั ะทะฐะดะฐัะฐ โ ะธะทะฒะปะตัั ะฟะฐัะฐะผะตััั ะธะท ะทะฐะฟัะพัะฐ ะฟะพะปัะทะพะฒะฐัะตะปั 
ะ ะะะะะะะะะขะฌ ะขะะ ะะะะะะกะ.

# ะัะพะดะฝัะต ะดะฐะฝะฝัะต:
ะะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั: {user_query}

# ะะฐะดะฐัะฐ:
ะะทะฒะปะตะบะธ ัะปะตะดัััะธะต ะฟะฐัะฐะผะตััั:

1. **ะขะะ ะะะะะะกะ** (query_type):
   - "compound_data" โ ะตัะปะธ ะทะฐะฟัะฐัะธะฒะฐัััั ัะฒะพะนััะฒะฐ/ะดะฐะฝะฝัะต ะพัะดะตะปัะฝะพะณะพ ะฒะตัะตััะฒะฐ ะะะ ัะตะฐะบัะธะธ
   - "reaction_calculation" โ ะตัะปะธ ััะตะฑัะตััั ัะฐัััั ัะตัะผะพะดะธะฝะฐะผะธะบะธ ัะธะผะธัะตัะบะพะน ัะตะฐะบัะธะธ

2. **ะฃัะฐะฒะฝะตะฝะฝะพะต ััะฐะฒะฝะตะฝะธะต ัะตะฐะบัะธะธ** (ัะพะปัะบะพ ะดะปั reaction_calculation)
   - ะกะฑะฐะปะฐะฝัะธััะน ััะตัะธะพะผะตััะธัะตัะบะธะต ะบะพัััะธัะธะตะฝัั
   - ะะปั compound_data ะพััะฐะฒั ะฟััััั ัััะพะบั ะธะปะธ "N/A"

3. **ะกะฟะธัะพะบ ะฒัะตั ะฒะตัะตััะฒ** (ะดะพ 10 ะฒะตัะตััะฒ)
   - ะะปั compound_data: ะพะดะฝะพ ะฒะตัะตััะฒะพ
   - ะะปั reaction_calculation: ัะตะฐะณะตะฝัั ะธ ะฟัะพะดัะบัั

4. **ะะตะฐะณะตะฝัั ะธ ะฟัะพะดัะบัั** (ัะพะปัะบะพ ะดะปั reaction_calculation)
   - ะะปั compound_data ะพััะฐะฒั ะฟััััะผะธ ัะฟะธัะบะฐะผะธ

5. **ะขะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ** ะฒ ะะตะปัะฒะธะฝะฐั (tmin, tmax)
   - ะะฑัะทะฐัะตะปะตะฝ ะดะปั ะพะฑะพะธั ัะธะฟะพะฒ
   - ะัะปะธ ะฝะต ัะบะฐะทะฐะฝ ัะฒะฝะพ, ะธัะฟะพะปัะทัะน 298-1000K

6. **ะจะฐะณ ัะตะผะฟะตัะฐัััั** (temperature_step_k)
   - ะะทะฒะปะตะบะฐะตััั ะธะท ััะฐะท: "ั ัะฐะณะพะผ X ะณัะฐะดััะพะฒ", "ะบะฐะถะดัะต X ะบะตะปัะฒะธะฝะพะฒ", "ัะตัะตะท X K"
   - ะะธะฐะฟะฐะทะพะฝ: 25-250K
   - ะะพ ัะผะพะปัะฐะฝะธั: 100K
   - ะัะธะผะตัั: "ั ัะฐะณะพะผ 50 ะณัะฐะดััะพะฒ" โ 50, "ะบะฐะถะดัะต 25K" โ 25

7. **ะะฐะทะฒะฐะฝะธั ะฒะตัะตััะฒ** โ IUPAC ะธ ััะธะฒะธะฐะปัะฝัะต ะฝะฐะทะฒะฐะฝะธั ะดะปั ะบะฐะถะดะพะณะพ ัะพะตะดะธะฝะตะฝะธั

# ะะะะะะะ ะะะะกะกะะคะะะะฆะะ:

## compound_data (ะดะฐะฝะฝัะต ะฟะพ ะฒะตัะตััะฒั):
โ ะะฐะฟัะพั ัะพะดะตัะถะธั ะพะดะฝะพ ะฒะตัะตััะฒะพ
โ ะะตั ัะธะผะฒะพะปะพะฒ ัะตะฐะบัะธะธ (โ, =, โ, <=>)
โ ะะปััะตะฒัะต ัะปะพะฒะฐ: "ะดะฐะฝะฝัะต", "ัะฒะพะนััะฒะฐ", "ัะฐะฑะปะธัะฐ ะดะปั", "ะธะฝัะพัะผะฐัะธั ะพ", "ัะตัะผะพะดะธะฝะฐะผะธะบะฐ [ะฒะตัะตััะฒะฐ]"
โ ะัะธะผะตัั:
  - "ะะฐะน ัะฐะฑะปะธัั ะดะปั H2O ะฟัะธ 300-600K"
  - "ะกะฒะพะนััะฒะฐ WCl6 ั ัะฐะณะพะผ 50 ะณัะฐะดััะพะฒ"
  - "ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ะดะฐะฝะฝัะต ะดะปั ะฒะพะดั"
  - "ะะฝัะพัะผะฐัะธั ะพ CO2 ะฒ ะดะธะฐะฟะฐะทะพะฝะต 400-800K"

## reaction_calculation (ัะฐัััั ัะตะฐะบัะธะธ):
โ ะัะธัััััะฒััั 2+ ะฒะตัะตััะฒะฐ
โ ะััั ัะธะผะฒะพะปั ัะตะฐะบัะธะธ (โ, =, โ, <=>)
โ ะะปััะตะฒัะต ัะปะพะฒะฐ: "ัะตะฐะบัะธั", "ัะฐัััะธัะฐะน", "ะฑะฐะปะฐะฝั", "ัะฐัััั ัะตัะผะพะดะธะฝะฐะผะธะบะธ", "ัะธะฝัะตะท", "ัะปะพัะธัะพะฒะฐะฝะธะต", "ะพะบะธัะปะตะฝะธะต"
โ ะัะธะผะตัั:
  - "2 W + 4 Cl2 + O2 โ 2 WOCl4 ะฟัะธ 600-900K"
  - "ะะฐัััะธัะฐะน ัะตัะผะพะดะธะฝะฐะผะธะบั ัะปะพัะธัะพะฒะฐะฝะธั ะฒะพะปัััะฐะผะฐ"
  - "ะกะธะฝัะตะท ะฐะผะผะธะฐะบะฐ ะธะท ะฐะทะพัะฐ ะธ ะฒะพะดะพัะพะดะฐ"
  - "ะะพัััะฐะฝะพะฒะปะตะฝะธะต Fe2O3 ะฒะพะดะพัะพะดะพะผ ะฟัะธ 800K"

# ะะะะะซะ ะะะะะะะ:
- ะะฐะบัะธะผัะผ 10 ะฒะตัะตััะฒ ะฒ ัะตะฐะบัะธะธ
- ะขะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ ะพะฑัะทะฐัะตะปะตะฝ (ะตัะปะธ ะฝะต ัะบะฐะทะฐะฝ, ะธัะฟะพะปัะทัะน 298-1000K ะฟะพ ัะผะพะปัะฐะฝะธั)
- ะคะพัะผัะปั ะฒะตัะตััะฒ โ ะฑะตะท ัะฐะท ะฒ ัะบะพะฑะบะฐั (ะฝะฐะฟัะธะผะตั, "H2O", ะฐ ะฝะต "H2O(g)")
- ะะปั ะบะฐะถะดะพะณะพ ะฒะตัะตััะฒะฐ ัะบะฐะถะธ ะพัะธัะธะฐะปัะฝะพะต IUPAC ะฝะฐะทะฒะฐะฝะธะต ะธ ะฒะพะทะผะพะถะฝัะต ััะธะฒะธะฐะปัะฝัะต ะฝะฐะทะฒะฐะฝะธั
- temperature_step_k ะดะพะปะถะตะฝ ะฑััั ะฒ ะดะธะฐะฟะฐะทะพะฝะต 25-250K

# ะะะะะะะซ ะะขะะะขะะ:

## ะัะธะผะตั 1 (compound_data):
ะะฐะฟัะพั: "ะะฐะน ัะฐะฑะปะธัั ะดะปั H2O ะฟัะธ 300-600K ั ัะฐะณะพะผ 50 ะณัะฐะดััะพะฒ"
ะัะฒะตั:
{{
  "query_type": "compound_data",
  "temperature_step_k": 50,
  "balanced_equation": "",
  "all_compounds": ["H2O"],
  "reactants": [],
  "products": [],
  "temperature_range_k": [300, 600],
  "extraction_confidence": 1.0,
  "missing_fields": [],
  "compound_names": {{
    "H2O": ["Water", "Dihydrogen monoxide", "ะฒะพะดะฐ"]
  }}
}}

## ะัะธะผะตั 2 (compound_data, ัะฐะณ ะฟะพ ัะผะพะปัะฐะฝะธั):
ะะฐะฟัะพั: "ะกะฒะพะนััะฒะฐ WCl6 ะฒ ะดะธะฐะฟะฐะทะพะฝะต 400-1000K"
ะัะฒะตั:
{{
  "query_type": "compound_data",
  "temperature_step_k": 100,
  "balanced_equation": "",
  "all_compounds": ["WCl6"],
  "reactants": [],
  "products": [],
  "temperature_range_k": [400, 1000],
  "extraction_confidence": 0.95,
  "missing_fields": [],
  "compound_names": {{
    "WCl6": ["Tungsten hexachloride", "Tungsten(VI) chloride"]
  }}
}}

## ะัะธะผะตั 3 (reaction_calculation):
ะะฐะฟัะพั: "ะฅะปะพัะธัะพะฒะฐะฝะธะต ะพะบัะธะดะฐ ัะธัะฐะฝะฐ ะฟัะธ 600-900K"
ะัะฒะตั:
{{
  "query_type": "reaction_calculation",
  "temperature_step_k": 100,
  "balanced_equation": "TiO2 + 2Cl2 โ TiCl4 + O2",
  "all_compounds": ["TiO2", "Cl2", "TiCl4", "O2"],
  "reactants": ["TiO2", "Cl2"],
  "products": ["TiCl4", "O2"],
  "temperature_range_k": [600, 900],
  "extraction_confidence": 0.95,
  "missing_fields": [],
  "compound_names": {{
    "TiO2": ["Titanium dioxide", "Titanium(IV) oxide"],
    "Cl2": ["Chlorine"],
    "TiCl4": ["Titanium tetrachloride", "Titanium(IV) chloride"],
    "O2": ["Oxygen"]
  }}
}}

## ะัะธะผะตั 4 (reaction_calculation, ัะฐะณ 25K):
ะะฐะฟัะพั: "2 W + 4 Cl2 + O2 โ 2 WOCl4 ะฟัะธ 600-900K, ััะธัะฐะน ะบะฐะถะดัะต 25 ะบะตะปัะฒะธะฝะพะฒ"
ะัะฒะตั:
{{
  "query_type": "reaction_calculation",
  "temperature_step_k": 25,
  "balanced_equation": "2 W + 4 Cl2 + O2 โ 2 WOCl4",
  "all_compounds": ["W", "Cl2", "O2", "WOCl4"],
  "reactants": ["W", "Cl2", "O2"],
  "products": ["WOCl4"],
  "temperature_range_k": [600, 900],
  "extraction_confidence": 1.0,
  "missing_fields": [],
  "compound_names": {{
    "W": ["Tungsten", "Wolfram"],
    "Cl2": ["Chlorine"],
    "O2": ["Oxygen"],
    "WOCl4": ["Tungsten oxychloride", "Tungsten oxytetrachloride"]
  }}
}}

## ะัะธะผะตั 5 (ัะปะพะถะฝะฐั ัะตะฐะบัะธั):
ะะฐะฟัะพั: "ะกะธะฝัะตะท ะฐะผะผะธะฐะบะฐ ะธะท ะฐะทะพัะฐ ะธ ะฒะพะดะพัะพะดะฐ ะฟัะธ 400-500ยฐC"
ะัะฒะตั:
{{
  "query_type": "reaction_calculation",
  "temperature_step_k": 100,
  "balanced_equation": "N2 + 3H2 โ 2NH3",
  "all_compounds": ["N2", "H2", "NH3"],
  "reactants": ["N2", "H2"],
  "products": ["NH3"],
  "temperature_range_k": [673, 773],
  "extraction_confidence": 1.0,
  "missing_fields": [],
  "compound_names": {{
    "N2": ["Nitrogen"],
    "H2": ["Hydrogen"],
    "NH3": ["Ammonia", "Azane"]
  }}
}}

ะขะตะฟะตัั ะพะฑัะฐะฑะพัะฐะน ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะฒะตัะฝะธ JSON ัะพะณะปะฐัะฝะพ ััะพะผั ัะพัะผะฐัั.
"""
```

### 8.2. ะะฐะปะธะดะฐัะธั ะฒ ExtractedReactionParameters

ะะพะฑะฐะฒะธัั ะฒะฐะปะธะดะฐัะธั ะดะปั ะฝะพะฒัั ะฟะพะปะตะน:

```python
from typing import Literal

class ExtractedReactionParameters(BaseModel):
    # ะกััะตััะฒัััะธะต ะฟะพะปั...
    
    # ะะพะฒัะต ะฟะพะปั
    query_type: Literal["compound_data", "reaction_calculation"] = Field(
        ...,
        description="ะขะธะฟ ะทะฐะฟัะพัะฐ: ะดะฐะฝะฝัะต ะฟะพ ะฒะตัะตััะฒั ะธะปะธ ัะฐัััั ัะตะฐะบัะธะธ"
    )
    
    temperature_step_k: int = Field(
        default=100,
        ge=25,
        le=250,
        description="ะจะฐะณ ัะตะผะฟะตัะฐัััั ะดะปั ัะฐะฑะปะธั, K (25-250)"
    )
    
    @field_validator('query_type')
    @classmethod
    def validate_query_type_consistency(cls, v, info):
        """ะัะพะฒะตัะบะฐ ัะพะณะปะฐัะพะฒะฐะฝะฝะพััะธ query_type ั ะดััะณะธะผะธ ะฟะพะปัะผะธ."""
        values = info.data
        
        if v == "compound_data":
            # ะะปั compound_data ะดะพะปะถะฝะพ ะฑััั ะพะดะฝะพ ะฒะตัะตััะฒะพ
            if len(values.get('all_compounds', [])) > 1:
                raise ValueError(
                    f"compound_data ะดะพะปะถะตะฝ ัะพะดะตัะถะฐัั ะพะดะฝะพ ะฒะตัะตััะฒะพ, "
                    f"ะฟะพะปััะตะฝะพ: {len(values['all_compounds'])}"
                )
            # ะะตะฐะณะตะฝัั ะธ ะฟัะพะดัะบัั ะดะพะปะถะฝั ะฑััั ะฟััััะผะธ
            if values.get('reactants') or values.get('products'):
                raise ValueError(
                    "compound_data ะฝะต ะดะพะปะถะตะฝ ัะพะดะตัะถะฐัั reactants/products"
                )
        
        elif v == "reaction_calculation":
            # ะะปั reaction_calculation ะดะพะปะถะฝะฐ ะฑััั ัะตะฐะบัะธั
            if len(values.get('all_compounds', [])) < 2:
                raise ValueError(
                    f"reaction_calculation ััะตะฑัะตั ะผะธะฝะธะผัะผ 2 ะฒะตัะตััะฒะฐ, "
                    f"ะฟะพะปััะตะฝะพ: {len(values.get('all_compounds', []))}"
                )
            # ะะพะปะถะฝะพ ะฑััั ััะฐะฒะฝะตะฝะธะต ัะตะฐะบัะธะธ
            if not values.get('balanced_equation') or values['balanced_equation'] == "N/A":
                raise ValueError(
                    "reaction_calculation ััะตะฑัะตั balanced_equation"
                )
        
        return v
    
    @field_validator('temperature_step_k')
    @classmethod
    def validate_temperature_step(cls, v):
        """ะัะพะฒะตัะบะฐ ัะฐะณะฐ ัะตะผะฟะตัะฐัััั."""
        if not (25 <= v <= 250):
            raise ValueError(
                f"temperature_step_k ะดะพะปะถะตะฝ ะฑััั ะฒ ะดะธะฐะฟะฐะทะพะฝะต 25-250K, ะฟะพะปััะตะฝะพ: {v}"
            )
        # ะะตะบะพะผะตะฝะดะฐัะธั: ัะฐะณ ะดะพะปะถะตะฝ ะฑััั ะบัะฐัะตะฝ 25
        if v % 25 != 0:
            import warnings
            warnings.warn(
                f"ะะตะบะพะผะตะฝะดัะตััั ะธัะฟะพะปัะทะพะฒะฐัั ัะฐะณ ะบัะฐัะฝัะน 25K (25, 50, 100, 150, 200, 250), "
                f"ะฟะพะปััะตะฝะพ: {v}K"
            )
        return v
```

### 8.3. ะขะตััะพะฒัะต ัะปััะฐะธ ะดะปั ะบะปะฐััะธัะธะบะฐัะธะธ

```python
# tests/test_query_classification.py

import pytest
from src.thermo_agents.models.extraction import ExtractedReactionParameters

class TestQueryClassification:
    """ะขะตััั ะดะปั ะบะปะฐััะธัะธะบะฐัะธะธ ัะธะฟะพะฒ ะทะฐะฟัะพัะพะฒ."""
    
    def test_compound_data_single_substance(self):
        """ะะดะธะฝ ะฒะตัะตััะฒะพ โ compound_data"""
        params = ExtractedReactionParameters(
            query_type="compound_data",
            temperature_step_k=100,
            balanced_equation="",
            all_compounds=["H2O"],
            reactants=[],
            products=[],
            temperature_range_k=(300, 600),
            extraction_confidence=1.0,
            compound_names={"H2O": ["Water"]}
        )
        assert params.query_type == "compound_data"
    
    def test_reaction_calculation_with_arrow(self):
        """ะะฐะปะธัะธะต โ ะธ 2+ ะฒะตัะตััะฒะฐ โ reaction_calculation"""
        params = ExtractedReactionParameters(
            query_type="reaction_calculation",
            temperature_step_k=100,
            balanced_equation="TiO2 + 2Cl2 โ TiCl4 + O2",
            all_compounds=["TiO2", "Cl2", "TiCl4", "O2"],
            reactants=["TiO2", "Cl2"],
            products=["TiCl4", "O2"],
            temperature_range_k=(600, 900),
            extraction_confidence=0.95,
            compound_names={
                "TiO2": ["Titanium dioxide"],
                "Cl2": ["Chlorine"],
                "TiCl4": ["Titanium tetrachloride"],
                "O2": ["Oxygen"]
            }
        )
        assert params.query_type == "reaction_calculation"
    
    def test_temperature_step_validation(self):
        """ะัะพะฒะตัะบะฐ ะฒะฐะปะธะดะฐัะธะธ ัะฐะณะฐ ัะตะผะฟะตัะฐัััั"""
        # ะะฐะปะธะดะฝัะน ัะฐะณ
        params = ExtractedReactionParameters(
            query_type="compound_data",
            temperature_step_k=50,
            all_compounds=["H2O"],
            reactants=[],
            products=[],
            temperature_range_k=(300, 600),
            extraction_confidence=1.0,
            balanced_equation="",
            compound_names={"H2O": ["Water"]}
        )
        assert params.temperature_step_k == 50
        
        # ะะตะฒะฐะปะธะดะฝัะน ัะฐะณ (ัะปะธัะบะพะผ ะผะฐะปะตะฝัะบะธะน)
        with pytest.raises(ValueError, match="25-250K"):
            ExtractedReactionParameters(
                query_type="compound_data",
                temperature_step_k=10,  # < 25
                all_compounds=["H2O"],
                reactants=[],
                products=[],
                temperature_range_k=(300, 600),
                extraction_confidence=1.0,
                balanced_equation="",
                compound_names={"H2O": ["Water"]}
            )
    
    def test_consistency_validation_compound_data_multiple_substances(self):
        """compound_data ั ะฝะตัะบะพะปัะบะธะผะธ ะฒะตัะตััะฒะฐะผะธ โ ะพัะธะฑะบะฐ"""
        with pytest.raises(ValueError, match="ะพะดะฝะพ ะฒะตัะตััะฒะพ"):
            ExtractedReactionParameters(
                query_type="compound_data",
                temperature_step_k=100,
                all_compounds=["H2O", "CO2"],  # ะะฒะฐ ะฒะตัะตััะฒะฐ!
                reactants=[],
                products=[],
                temperature_range_k=(300, 600),
                extraction_confidence=1.0,
                balanced_equation="",
                compound_names={"H2O": ["Water"], "CO2": ["Carbon dioxide"]}
            )
    
    def test_consistency_validation_reaction_without_equation(self):
        """reaction_calculation ะฑะตะท ััะฐะฒะฝะตะฝะธั โ ะพัะธะฑะบะฐ"""
        with pytest.raises(ValueError, match="balanced_equation"):
            ExtractedReactionParameters(
                query_type="reaction_calculation",
                temperature_step_k=100,
                all_compounds=["TiO2", "Cl2"],
                reactants=["TiO2", "Cl2"],
                products=[],
                temperature_range_k=(600, 900),
                extraction_confidence=0.95,
                balanced_equation="",  # ะัััะพะต ััะฐะฒะฝะตะฝะธะต!
                compound_names={"TiO2": ["Titanium dioxide"], "Cl2": ["Chlorine"]}
            )
```

### 8.4. ะัะธะผะตัั ะทะฐะฟัะพัะพะฒ ะธ ะพะถะธะดะฐะตะผะฐั ะบะปะฐััะธัะธะบะฐัะธั

| ะะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั                    | query_type           | temperature_step_k | ะัะธะผะตัะฐะฝะธะต          |
| -------------------------------------- | -------------------- | ------------------ | ------------------- |
| "ะะฐะน ัะฐะฑะปะธัั ะดะปั H2O ะฟัะธ 300-600K"     | compound_data        | 100                | ะะพ ัะผะพะปัะฐะฝะธั        |
| "ะกะฒะพะนััะฒะฐ WCl6 ั ัะฐะณะพะผ 50 ะณัะฐะดััะพะฒ"    | compound_data        | 50                 | ะะทะฒะปะตััะฝ ะธะท ะทะฐะฟัะพัะฐ |
| "ะะฝัะพัะผะฐัะธั ะพ CO2 ะบะฐะถะดัะต 25K"          | compound_data        | 25                 | ะะธะฝะธะผะฐะปัะฝัะน ัะฐะณ     |
| "2 W + 4 Cl2 โ 2 WCl6 ะฟัะธ 600K"        | reaction_calculation | 100                | ะะตะฐะบัะธั             |
| "ะะฐัััะธัะฐะน ัะตัะผะพะดะธะฝะฐะผะธะบั ัะปะพัะธัะพะฒะฐะฝะธั" | reaction_calculation | 100                | ะะปััะตะฒะพะต ัะปะพะฒะพ      |
| "ะกะธะฝัะตะท NH3 ะธะท N2 ะธ H2 ัะตัะตะท 150K"     | reaction_calculation | 150                | ะจะฐะณ ะธะท ะทะฐะฟัะพัะฐ      |

---

### 4.2. ะะพะฒัะต ะบะพะผะฟะพะฝะตะฝัั

- `ThermodynamicCalculator` โ ัะฐัััั H(T), S(T), G(T) ะฟะพ ัะพัะผัะปะฐะผ
- `CompoundDataFormatter` โ ัะพัะผะฐัะธัะพะฒะฐะฝะธะต ะดะปั ัะธะฟะฐ `compound_data`
- `ReactionCalculationFormatter` โ ัะพัะผะฐัะธัะพะฒะฐะฝะธะต ะดะปั ัะธะฟะฐ `reaction_calculation`

### 4.3. Orchestrator (ะผะพะดะธัะธะบะฐัะธั)

ะะพะฑะฐะฒะธัั ะผะฐัััััะธะทะฐัะธั ะฟะพ ัะธะฟั ะทะฐะฟัะพัะฐ:

```python
async def process_query(self, user_query: str) -> str:
    params = await self.thermodynamic_agent.extract_parameters(user_query)
    
    if params.query_type == "compound_data":
        return await self._process_compound_data(params)
    else:
        return await self._process_reaction_calculation(params)
```

---

## 5. ะัะธะพัะธัะตัั ัะตะฐะปะธะทะฐัะธะธ

1. **ะคะฐะทะฐ 1:** ะะฐััะธัะตะฝะธะต `ExtractedReactionParameters` + ะพะฑะฝะพะฒะปะตะฝะธะต ะฟัะพะผะฟัะฐ
2. **ะคะฐะทะฐ 2:** ะกะพะทะดะฐะฝะธะต `ThermodynamicCalculator` (ะฟะตัะตะฝะพั ะปะพะณะธะบะธ ะธะท notebook)
3. **ะคะฐะทะฐ 3:** ะกะพะทะดะฐะฝะธะต ัะพัะผะฐััะตัะพะฒ `CompoundDataFormatter` ะธ `ReactionCalculationFormatter`
4. **ะคะฐะทะฐ 4:** ะะพะดะธัะธะบะฐัะธั `Orchestrator` ะดะปั ะผะฐัััััะธะทะฐัะธะธ
5. **ะคะฐะทะฐ 5:** ะขะตััะธัะพะฒะฐะฝะธะต ะธ ะดะพะบัะผะตะฝัะฐัะธั

---

## 6. ะะธัะบะธ ะธ ะพะณัะฐะฝะธัะตะฝะธั

### ะะธัะบะธ
- ะฃะฒะตะปะธัะตะฝะธะต ัะปะพะถะฝะพััะธ ะฟัะพะผะฟัะฐ ะผะพะถะตั ัะฝะธะทะธัั ัะพัะฝะพััั ะธะทะฒะปะตัะตะฝะธั
- ะะฐัััั ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฐะฑะปะธั ะดะปั ะบะฐะถะดะพะณะพ ะฒะตัะตััะฒะฐ ะผะพะถะตั ะฑััั ะผะตะดะปะตะฝะฝัะผ

### ะะณัะฐะฝะธัะตะฝะธั
- ะคะพัะผัะปั ะจะพะผะตะนัะฐ ัะฐะฑะพัะฐัั ัะพะปัะบะพ ะฒ ะฟัะตะดะตะปะฐั Tmin-Tmax ะธะท ะฑะฐะทั ะดะฐะฝะฝัั
- ะจะฐะณ ัะตะผะฟะตัะฐัััั 25-250K (ะฒะฝะต ะดะธะฐะฟะฐะทะพะฝะฐ โ ะพัะธะฑะบะฐ ะฒะฐะปะธะดะฐัะธะธ)

---

## 7. ะะปะฐะฝ ัะตััะธัะพะฒะฐะฝะธั

- Unit-ัะตััั ะดะปั `ThermodynamicCalculator`
- ะะฝัะตะณัะฐัะธะพะฝะฝัะต ัะตััั ะดะปั ะฝะพะฒัั ัะพัะผะฐััะตัะพะฒ
- E2E ัะตััั ะดะปั ะพะฑะพะธั ัะธะฟะพะฒ ะทะฐะฟัะพัะพะฒ
- Performance-ัะตััั ะดะปั ะณะตะฝะตัะฐัะธะธ ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฐะฑะปะธั

---

## 9. ะะตัะฐะปะธ ัะตะฐะปะธะทะฐัะธะธ: ThermodynamicCalculator

### 9.1. ะะฐะทะฝะฐัะตะฝะธะต ะธ ะฐััะธัะตะบัััะฐ

**ะะตััะพะฟะพะปะพะถะตะฝะธะต:** `src/thermo_agents/calculations/thermodynamic_calculator.py` (ะฝะพะฒัะน ะผะพะดัะปั)

**ะฆะตะปั:** ะะตัะตัะผะธะฝะธัะพะฒะฐะฝะฝัะน ัะฐัััั ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฒะพะนััะฒ H(T), S(T), G(T) ะดะปั ะฒะตัะตััะฒ ะธ ัะตะฐะบัะธะน ะฝะฐ ะพัะฝะพะฒะต ัะพัะผัะป ะจะพะผะตะนัะฐ.

**ะััะพัะฝะธะบ ะปะพะณะธะบะธ:** ะะตัะตะฝะพั ะธะท `docs/ัhlorination_of_tungsten.ipynb` (ััะตะนะบะธ ั ััะฝะบัะธัะผะธ `cp_function_from_row`, `H_S_G_from_row`, `thermodynamic_table`)

### 9.2. API ะบะปะฐััะฐ ThermodynamicCalculator

```python
from dataclasses import dataclass
from typing import List, Tuple, Optional
import numpy as np
from src.thermo_agents.models.search import DatabaseRecord


@dataclass
class ThermodynamicProperties:
    """ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ัะฒะพะนััะฒะฐ ะฟัะธ ะทะฐะดะฐะฝะฝะพะน ัะตะผะฟะตัะฐัััะต."""
    T: float  # ะขะตะผะฟะตัะฐัััะฐ, K
    Cp: float  # ะขะตะฟะปะพัะผะบะพััั, ะะถ/(ะผะพะปัยทK)
    H: float  # ะญะฝัะฐะปัะฟะธั, ะะถ/ะผะพะปั
    S: float  # ะญะฝััะพะฟะธั, ะะถ/(ะผะพะปัยทK)
    G: float  # ะญะฝะตัะณะธั ะะธะฑะฑัะฐ, ะะถ/ะผะพะปั


@dataclass
class ThermodynamicTable:
    """ะขะฐะฑะปะธัะฐ ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฒะพะนััะฒ ะฟะพ ะดะธะฐะฟะฐะทะพะฝั ัะตะผะฟะตัะฐััั."""
    formula: str
    phase: str
    temperature_range: Tuple[float, float]
    properties: List[ThermodynamicProperties]  # ะกะตัะบะฐ ะฟะพ T
    
    def to_dict(self) -> dict:
        """ะัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะฒ ัะปะพะฒะฐัั ะดะปั ัะพัะผะฐััะตัะฐ."""
        return {
            'formula': self.formula,
            'phase': self.phase,
            'T_range': self.temperature_range,
            'data': [
                {
                    'T': prop.T,
                    'Cp': prop.Cp,
                    'H': prop.H / 1000,  # ะะถ โ ะบะะถ
                    'S': prop.S,
                    'G': prop.G / 1000   # ะะถ โ ะบะะถ
                }
                for prop in self.properties
            ]
        }


class ThermodynamicCalculator:
    """
    ะะตัะตัะผะธะฝะธัะพะฒะฐะฝะฝัะน ะบะฐะปัะบัะปััะพั ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฒะพะนััะฒ.
    
    ะัะฟะพะปัะทัะตั ัะพัะผัะปั ะจะพะผะตะนัะฐ ะดะปั ัะฐััััะฐ Cp(T), H(T), S(T), G(T).
    ะัะฝะพะฒะฐะฝ ะฝะฐ ัะธัะปะตะฝะฝะพะผ ะธะฝัะตะณัะธัะพะฒะฐะฝะธะธ ะผะตัะพะดะพะผ ััะฐะฟะตัะธะน.
    """
    
    T_REF = 298.15  # ะะตัะตัะตะฝัะฝะฐั ัะตะผะฟะตัะฐัััะฐ, K
    
    def __init__(self):
        """ะะฝะธัะธะฐะปะธะทะฐัะธั ะบะฐะปัะบัะปััะพัะฐ."""
        self.num_integration_points = 400  # ะะพะปะธัะตััะฒะพ ัะพัะตะบ ะดะปั ะธะฝัะตะณัะธัะพะฒะฐะฝะธั
    
    def calculate_cp(self, record: DatabaseRecord, T: float) -> float:
        """
        ะะฐัััั ัะตะฟะปะพัะผะบะพััะธ Cp(T) ะฟะพ ัะพัะผัะปะต ะจะพะผะตะนัะฐ.
        
        ะคะพัะผัะปะฐ:
        Cp(T) = f1 + f2*T/1000 + f3*T^(-2)*10^5 + f4*T^2/10^6 + f5*T^(-3)*10^3 + f6*T^3*10^(-9)
        
        Args:
            record: ะะฐะฟะธัั ะธะท ะฑะฐะทั ะดะฐะฝะฝัั ั ะบะพัััะธัะธะตะฝัะฐะผะธ f1-f6
            T: ะขะตะผะฟะตัะฐัััะฐ, K
        
        Returns:
            Cp ะฒ ะะถ/(ะผะพะปัยทK)
        """
        T = float(T)
        f1 = record.f1 or 0.0
        f2 = record.f2 or 0.0
        f3 = record.f3 or 0.0
        f4 = record.f4 or 0.0
        f5 = record.f5 or 0.0
        f6 = record.f6 or 0.0
        
        return (
            f1
            + f2 * T / 1000.0
            + f3 * T**(-2) * 100_000.0
            + f4 * T**2 / 1_000_000.0
            + f5 * T**(-3) * 1_000.0
            + f6 * T**3 * 1e-9
        )
    
    def calculate_properties(
        self, 
        record: DatabaseRecord, 
        T: float
    ) -> ThermodynamicProperties:
        """
        ะะฐัััั ะฒัะตั ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฒะพะนััะฒ ะฟัะธ ัะตะผะฟะตัะฐัััะต T.
        
        ะคะพัะผัะปั:
        - H(T) = H298 + โซ[298โT] Cp(T) dT
        - S(T) = S298 + โซ[298โT] Cp(T)/T dT  
        - G(T) = H(T) - T*S(T)
        
        Args:
            record: ะะฐะฟะธัั ะธะท ะฑะฐะทั ะดะฐะฝะฝัั
            T: ะขะตะผะฟะตัะฐัััะฐ, K
        
        Returns:
            ThermodynamicProperties ั Cp, H, S, G
        
        Raises:
            ValueError: ะัะปะธ T ะฒััะพะดะธั ะทะฐ ะฟัะตะดะตะปั Tmin-Tmax
        """
        T = float(T)
        
        # ะะฐะปะธะดะฐัะธั ัะตะผะฟะตัะฐัััะฝะพะณะพ ะดะธะฐะฟะฐะทะพะฝะฐ
        if record.Tmin and T < record.Tmin:
            raise ValueError(
                f"T={T}K ะฝะธะถะต ะผะธะฝะธะผะฐะปัะฝะพะน ัะตะผะฟะตัะฐัััั {record.Tmin}K "
                f"ะดะปั {record.Formula} ({record.Phase})"
            )
        if record.Tmax and T > record.Tmax:
            raise ValueError(
                f"T={T}K ะฒััะต ะผะฐะบัะธะผะฐะปัะฝะพะน ัะตะผะฟะตัะฐัััั {record.Tmax}K "
                f"ะดะปั {record.Formula} ({record.Phase})"
            )
        
        # ะะฐะทะพะฒัะต ะทะฝะฐัะตะฝะธั ะฟัะธ 298.15K
        H298 = (record.H298 or 0.0) * 1000.0  # ะบะะถ/ะผะพะปั โ ะะถ/ะผะพะปั
        S298 = record.S298 or 0.0  # ะะถ/(ะผะพะปัยทK)
        
        # ะขะตะบััะฐั ัะตะฟะปะพัะผะบะพััั
        Cp = self.calculate_cp(record, T)
        
        # ะัะปะธ T ะฑะปะธะทะบะฐ ะบ ัะตัะตัะตะฝัะฝะพะน, ะฝะต ััะตะฑัะตััั ะธะฝัะตะณัะธัะพะฒะฐะฝะธะต
        if abs(T - self.T_REF) < 1e-9:
            H = H298
            S = S298
            G = H - T * S
            return ThermodynamicProperties(T=T, Cp=Cp, H=H, S=S, G=G)
        
        # ะงะธัะปะตะฝะฝะพะต ะธะฝัะตะณัะธัะพะฒะฐะฝะธะต ะผะตัะพะดะพะผ ััะฐะฟะตัะธะน
        T_grid = np.linspace(self.T_REF, T, self.num_integration_points)
        Cp_grid = np.array([self.calculate_cp(record, t) for t in T_grid])
        
        # ฮH = โซ Cp(T) dT
        delta_H = np.trapz(Cp_grid, T_grid)
        
        # ฮS = โซ Cp(T)/T dT
        delta_S = np.trapz(Cp_grid / T_grid, T_grid)
        
        # ะคะธะฝะฐะปัะฝัะต ะทะฝะฐัะตะฝะธั
        H = H298 + delta_H
        S = S298 + delta_S
        G = H - T * S
        
        return ThermodynamicProperties(T=T, Cp=Cp, H=H, S=S, G=G)
    
    def generate_table(
        self,
        record: DatabaseRecord,
        T_min: float,
        T_max: float,
        step_k: int = 100
    ) -> ThermodynamicTable:
        """
        ะะตะฝะตัะฐัะธั ัะฐะฑะปะธัั ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฒะพะนััะฒ ะฟะพ ะดะธะฐะฟะฐะทะพะฝั ัะตะผะฟะตัะฐััั.
        
        Args:
            record: ะะฐะฟะธัั ะธะท ะฑะฐะทั ะดะฐะฝะฝัั
            T_min: ะะธะฝะธะผะฐะปัะฝะฐั ัะตะผะฟะตัะฐัััะฐ, K
            T_max: ะะฐะบัะธะผะฐะปัะฝะฐั ัะตะผะฟะตัะฐัััะฐ, K
            step_k: ะจะฐะณ ะฟะพ ัะตะผะฟะตัะฐัััะต, K (25-250)
        
        Returns:
            ThermodynamicTable ั ัะฐัััะธัะฐะฝะฝัะผะธ ัะฒะพะนััะฒะฐะผะธ
        
        Raises:
            ValueError: ะัะปะธ step_k ะฒะฝะต ะดะธะฐะฟะฐะทะพะฝะฐ 25-250K
        """
        if not (25 <= step_k <= 250):
            raise ValueError(f"ะจะฐะณ ะดะพะปะถะตะฝ ะฑััั ะฒ ะดะธะฐะฟะฐะทะพะฝะต 25-250K, ะฟะพะปััะตะฝะพ: {step_k}K")
        
        # ะะณัะฐะฝะธัะตะฝะธะต ะดะธะฐะฟะฐะทะพะฝะฐ ะฟัะตะดะตะปะฐะผะธ Tmin-Tmax ะทะฐะฟะธัะธ
        effective_T_min = max(T_min, record.Tmin or T_min)
        effective_T_max = min(T_max, record.Tmax or T_max)
        
        # ะะบััะณะปะตะฝะธะต T_min ะฒะฒะตัั ะดะพ ะฑะปะธะถะฐะนัะตะณะพ ะบัะฐัะฝะพะณะพ step_k
        T_start = int(np.ceil(effective_T_min / step_k) * step_k)
        
        # ะะตะฝะตัะฐัะธั ัะตัะบะธ ัะตะผะฟะตัะฐััั
        T_values = np.arange(T_start, effective_T_max + 1, step_k)
        
        # ะะฐัััั ัะฒะพะนััะฒ ะดะปั ะบะฐะถะดะพะน ัะตะผะฟะตัะฐัััั
        properties = []
        for T in T_values:
            try:
                props = self.calculate_properties(record, T)
                properties.append(props)
            except ValueError as e:
                # ะัะพะฟััะบ ัะตะผะฟะตัะฐััั ะฒะฝะต ะดะธะฐะฟะฐะทะพะฝะฐ
                continue
        
        return ThermodynamicTable(
            formula=record.Formula,
            phase=record.Phase,
            temperature_range=(effective_T_min, effective_T_max),
            properties=properties
        )
    
    def calculate_reaction_properties(
        self,
        reactants: List[Tuple[DatabaseRecord, int]],  # [(record, stoich_coeff), ...]
        products: List[Tuple[DatabaseRecord, int]],
        T: float
    ) -> Tuple[float, float, float]:
        """
        ะะฐัััั ฮH, ฮS, ฮG ัะตะฐะบัะธะธ ะฟัะธ ะทะฐะดะฐะฝะฝะพะน ัะตะผะฟะตัะฐัััะต.
        
        ะคะพัะผัะปั:
        - ฮHยฐ(T) = ฮฃ(ฮฝแตข * Hแตข(T))_products - ฮฃ(ฮฝโฑผ * Hโฑผ(T))_reactants
        - ฮSยฐ(T) = ฮฃ(ฮฝแตข * Sแตข(T))_products - ฮฃ(ฮฝโฑผ * Sโฑผ(T))_reactants
        - ฮGยฐ(T) = ฮHยฐ(T) - T*ฮSยฐ(T)
        
        Args:
            reactants: ะกะฟะธัะพะบ (ะทะฐะฟะธัั, ััะตัะธะพะผะตััะธัะตัะบะธะน ะบะพัััะธัะธะตะฝั) ัะตะฐะณะตะฝัะพะฒ
            products: ะกะฟะธัะพะบ (ะทะฐะฟะธัั, ััะตัะธะพะผะตััะธัะตัะบะธะน ะบะพัััะธัะธะตะฝั) ะฟัะพะดัะบัะพะฒ
            T: ะขะตะผะฟะตัะฐัััะฐ, K
        
        Returns:
            (ฮH, ฮS, ฮG) ะฒ ะะถ/ะผะพะปั, ะะถ/(ะผะพะปัยทK), ะะถ/ะผะพะปั
        """
        delta_H = 0.0
        delta_S = 0.0
        
        # ะะบะปะฐะด ะฟัะพะดัะบัะพะฒ (ะฟะพะปะพะถะธัะตะปัะฝัะน)
        for record, nu in products:
            props = self.calculate_properties(record, T)
            delta_H += nu * props.H
            delta_S += nu * props.S
        
        # ะะบะปะฐะด ัะตะฐะณะตะฝัะพะฒ (ะพััะธัะฐัะตะปัะฝัะน)
        for record, nu in reactants:
            props = self.calculate_properties(record, T)
            delta_H -= nu * props.H
            delta_S -= nu * props.S
        
        # ะญะฝะตัะณะธั ะะธะฑะฑัะฐ
        delta_G = delta_H - T * delta_S
        
        return (delta_H, delta_S, delta_G)
```

### 9.3. ะะฑัะฐะฑะพัะบะฐ ะณัะฐะฝะธัะฝัั ัะปััะฐะตะฒ

**ะขะตะผะฟะตัะฐัััะฐ ะฒะฝะต ะดะธะฐะฟะฐะทะพะฝะฐ Tmin-Tmax:**
```python
# ะัะธะผะตั: record.Tmin=400K, record.Tmax=1000K
# ะะฐะฟัะพั: T_min=300K, T_max=1200K

effective_T_min = max(300, 400) = 400K  # ะะฑัะตะทะบะฐ ัะฝะธะทั
effective_T_max = min(1200, 1000) = 1000K  # ะะฑัะตะทะบะฐ ัะฒะตััั

# ะัะตะดัะฟัะตะถะดะตะฝะธะต ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั:
"โ๏ธ ะขะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ 300-1200K ะพะฑัะตะทะฐะฝ ะดะพ 400-1000K 
   (ะฟัะตะดะตะปั ะฟัะธะผะตะฝะธะผะพััะธ ะดะฐะฝะฝัั ะดะปั H2O(g))"
```

**ะะตัะบะพะปัะบะพ ะทะฐะฟะธัะตะน ะดะปั ะพะดะฝะพะณะพ ะฒะตัะตััะฒะฐ:**
```python
# ะัะธะผะตั: O2(g) ะธะผะตะตั ะดะฒะต ะทะฐะฟะธัะธ ั ัะฐะทะฝัะผะธ ะดะธะฐะฟะฐะทะพะฝะฐะผะธ
# Record 1: Tmin=298K, Tmax=700K
# Record 2: Tmin=700K, Tmax=1200K

# ะกััะฐัะตะณะธั: ะฒัะฑะพั ะทะฐะฟะธัะธ ะฟะพ ัะตะผะฟะตัะฐัััะต ัะตัะตะท FilterPipeline
# ะะปั compound_data: ะณะตะฝะตัะธััะตััั ะพะดะฝะฐ ัะฐะฑะปะธัะฐ ั ะฟะตัะตะบะปััะตะฝะธะตะผ ะทะฐะฟะธัะตะน
# ะะปั reaction_calculation: ะฒัะฑะธัะฐะตััั ะทะฐะฟะธัั, ะฟะพะบััะฒะฐััะฐั ะฒะตัั ะดะธะฐะฟะฐะทะพะฝ
```

### 9.4. ะะฟัะธะผะธะทะฐัะธะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ

**ะััะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ ะธะฝัะตะณัะธัะพะฒะฐะฝะธั:**
```python
from functools import lru_cache

class ThermodynamicCalculator:
    @lru_cache(maxsize=1000)
    def _cached_integration(
        self, 
        record_id: int,  # ะฃะฝะธะบะฐะปัะฝัะน ID ะทะฐะฟะธัะธ
        T: float
    ) -> Tuple[float, float]:
        """
        ะััะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ ะธะฝัะตะณัะธัะพะฒะฐะฝะธั ะดะปั (record_id, T).
        
        Returns:
            (delta_H, delta_S)
        """
        # ะะฝัะตะณัะธัะพะฒะฐะฝะธะต ะฒัะฟะพะปะฝัะตััั ะพะดะธะฝ ัะฐะท ะดะปั ะบะฐะถะดะพะน ะฟะฐัั (record, T)
        ...
```

**ะะตะบัะพัะธะทะฐัะธั ัะฐััััะพะฒ:**
```python
def generate_table_vectorized(
    self,
    record: DatabaseRecord,
    T_values: np.ndarray
) -> ThermodynamicTable:
    """
    ะะตะบัะพัะธะทะพะฒะฐะฝะฝะฐั ะณะตะฝะตัะฐัะธั ัะฐะฑะปะธัั ะดะปั ะผะฐััะธะฒะฐ ัะตะผะฟะตัะฐััั.
    
    ะัะฟะพะปัะทัะตั NumPy ะดะปั ะฟะฐัะฐะปะปะตะปัะฝัั ะฒััะธัะปะตะฝะธะน Cp(T) ะฟะพ ะฒัะตะน ัะตัะบะต.
    ~5x ะฑััััะตะต, ัะตะผ ัะธะบะปะธัะตัะบะธะน ัะฐัััั ะดะปั ะบะฐะถะดะพะน ัะตะผะฟะตัะฐัััั.
    """
    # ะะตะบัะพัะฝัะน ัะฐัััั Cp ะดะปั ะฒัะตั T ะพะดะฝะพะฒัะตะผะตะฝะฝะพ
    T = T_values
    f1, f2, f3, f4, f5, f6 = [record.f1 or 0.0, ...]
    
    Cp_grid = (
        f1 
        + f2 * T / 1000.0 
        + f3 * T**(-2) * 100_000.0 
        + ...
    )
    
    # ะะตะบัะพัะฝะพะต ะธะฝัะตะณัะธัะพะฒะฐะฝะธะต ะดะปั ะบะฐะถะดะพะน ัะตะผะฟะตัะฐัััั
    # (ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั cumtrapz ะดะปั ะบัะผัะปััะธะฒะฝะพะณะพ ะธะฝัะตะณัะธัะพะฒะฐะฝะธั)
    ...
```

### 9.5. ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

**ะัะธะผะตั 1: ะะตะฝะตัะฐัะธั ัะฐะฑะปะธัั ะดะปั H2O**
```python
calculator = ThermodynamicCalculator()

# ะะพะปััะตะฝะธะต ะทะฐะฟะธัะธ ะธะท ะฑะฐะทั ะดะฐะฝะฝัั
record = database.get_record(formula="H2O", phase="g", T=500)

# ะะตะฝะตัะฐัะธั ัะฐะฑะปะธัั ั ัะฐะณะพะผ 50K
table = calculator.generate_table(
    record=record,
    T_min=300,
    T_max=600,
    step_k=50
)

# ะะตะทัะปััะฐั:
# ThermodynamicTable(
#     formula="H2O",
#     phase="g",
#     temperature_range=(300, 600),
#     properties=[
#         ThermodynamicProperties(T=300, Cp=33.58, H=-241760, S=189.04, G=-298470),
#         ThermodynamicProperties(T=350, Cp=34.26, H=-240080, S=193.54, G=-307819),
#         ...
#     ]
# )
```

**ะัะธะผะตั 2: ะะฐัััั ัะตะฐะบัะธะธ 2 W + 4 Cl2 + O2 โ 2 WOCl4**
```python
# ะะพะปััะตะฝะธะต ะทะฐะฟะธัะตะน ะฒะตัะตััะฒ
W = database.get_record("W", "s", 873)
Cl2 = database.get_record("Cl2", "g", 873)
O2 = database.get_record("O2", "g", 873)
WOCl4 = database.get_record("WOCl4", "g", 873)

# ะะฐัััั ะฟัะธ 873K (600ยฐC)
delta_H, delta_S, delta_G = calculator.calculate_reaction_properties(
    reactants=[(W, 2), (Cl2, 4), (O2, 1)],
    products=[(WOCl4, 2)],
    T=873
)

# ะะพัะผะธัะพะฒะบะฐ ะฝะฐ ะผะพะปั ะฟัะพะดัะบัะฐ (2 ะผะพะปั WOCl4)
product_moles = 2
delta_H_per_mol = delta_H / 1000 / product_moles  # ะบะะถ/ะผะพะปั
delta_S_per_mol = delta_S / product_moles  # ะะถ/(ะยทะผะพะปั)
delta_G_per_mol = delta_G / 1000 / product_moles  # ะบะะถ/ะผะพะปั

print(f"873 K: ฮHยฐ = {delta_H_per_mol:.2f} ะบะะถ/ะผะพะปั | "
      f"ฮSยฐ = {delta_S_per_mol:.2f} ะะถ/(ะยทะผะพะปั) | "
      f"ฮGยฐ = {delta_G_per_mol:.2f} ะบะะถ/ะผะพะปั")
```

---

## 10. ะะตัะฐะปะธ ัะตะฐะปะธะทะฐัะธะธ: CompoundDataFormatter

### 10.1. ะะฐะทะฝะฐัะตะฝะธะต ะธ ะฐััะธัะตะบัััะฐ

**ะะตััะพะฟะพะปะพะถะตะฝะธะต:** `src/thermo_agents/formatting/compound_data_formatter.py` (ะฝะพะฒัะน ะผะพะดัะปั)

**ะฆะตะปั:** ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะดะฐะฝะฝัั ะดะปั ะทะฐะฟัะพัะพะฒ ัะธะฟะฐ `compound_data` โ ะฒัะฒะพะด ะฑะฐะทะพะฒัั ัะฒะพะนััะฒ ะธ ัะฐะฑะปะธัั ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ะดะฐะฝะฝัั ะฟะพ ัะตะผะฟะตัะฐัััะต.

### 10.2. API ะบะปะฐััะฐ CompoundDataFormatter

```python
from typing import Optional
from tabulate import tabulate
from src.thermo_agents.models.search import DatabaseRecord, CompoundSearchResult
from src.thermo_agents.calculations.thermodynamic_calculator import (
    ThermodynamicCalculator,
    ThermodynamicTable
)


class CompoundDataFormatter:
    """
    ะคะพัะผะฐััะตั ะดะปั ะฒัะฒะพะดะฐ ัะฐะฑะปะธัะฝัั ะดะฐะฝะฝัั ะฒะตัะตััะฒ.
    
    ะะตะฝะตัะธััะตั:
    - ะะฐะทะพะฒัะต ัะฒะพะนััะฒะฐ ะฒะตัะตััะฒะฐ (ัะพัะผัะปะฐ, ะฝะฐะทะฒะฐะฝะธะต, ัะฐะทะฐ, H298, S298, etc.)
    - ะขะฐะฑะปะธัั ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฒะพะนััะฒ Cp, H, S, G ะฟะพ ะดะธะฐะฟะฐะทะพะฝั ัะตะผะฟะตัะฐััั
    """
    
    def __init__(self, calculator: ThermodynamicCalculator):
        """
        ะะฝะธัะธะฐะปะธะทะฐัะธั ัะพัะผะฐััะตัะฐ.
        
        Args:
            calculator: ะญะบะทะตะผะฟะปัั ThermodynamicCalculator ะดะปั ัะฐััััะฐ ัะฒะพะนััะฒ
        """
        self.calculator = calculator
    
    def format_response(
        self,
        result: CompoundSearchResult,
        T_min: float,
        T_max: float,
        step_k: int = 100
    ) -> str:
        """
        ะะตะฝะตัะฐัะธั ะฟะพะปะฝะพะณะพ ะพัะฒะตัะฐ ะดะปั ะทะฐะฟัะพัะฐ ะดะฐะฝะฝัั ะฟะพ ะฒะตัะตััะฒั.
        
        Args:
            result: ะะตะทัะปััะฐั ะฟะพะธัะบะฐ ะฒะตัะตััะฒะฐ ะฒ ะฑะฐะทะต
            T_min: ะะธะฝะธะผะฐะปัะฝะฐั ัะตะผะฟะตัะฐัััะฐ ะดะธะฐะฟะฐะทะพะฝะฐ, K
            T_max: ะะฐะบัะธะผะฐะปัะฝะฐั ัะตะผะฟะตัะฐัััะฐ ะดะธะฐะฟะฐะทะพะฝะฐ, K
            step_k: ะจะฐะณ ัะตะผะฟะตัะฐัััั, K (25-250)
        
        Returns:
            ะััะพัะผะฐัะธัะพะฒะฐะฝะฝัะน ัะตะบััะพะฒัะน ะพัะฒะตั
        
        Raises:
            ValueError: ะัะปะธ ะฒะตัะตััะฒะพ ะฝะต ะฝะฐะนะดะตะฝะพ ะธะปะธ ะฝะตะบะพััะตะบัะฝัะต ะฟะฐัะฐะผะตััั
        """
        if not result.records_found:
            return self._format_not_found_response(result.formula)
        
        # ะัะฑะพั ะปัััะตะน ะทะฐะฟะธัะธ (ะฟัะธะพัะธัะตะทะฐัะธั ัะถะต ะฒัะฟะพะปะฝะตะฝะฐ FilterPipeline)
        record = result.records_found[0]
        
        lines = []
        
        # ะะฐะณะพะปะพะฒะพะบ
        lines.append(f"๐ ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ะดะฐะฝะฝัะต: {record.Formula}")
        lines.append("")
        
        # ะะฐะทะพะฒัะต ัะฒะพะนััะฒะฐ
        lines.append("ะะฐะทะพะฒัะต ัะฒะพะนััะฒะฐ:")
        lines.append(self._format_basic_properties(record))
        lines.append("")
        
        # ะขะฐะฑะปะธัะฐ ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฒะพะนััะฒ
        try:
            table = self.calculator.generate_table(record, T_min, T_max, step_k)
            lines.append("ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ัะฒะพะนััะฒะฐ ะฟะพ ัะตะผะฟะตัะฐัััะต:")
            lines.append(self._format_thermodynamic_table(table))
            lines.append("")
        except ValueError as e:
            lines.append(f"โ๏ธ ะัะธะฑะบะฐ ะณะตะฝะตัะฐัะธะธ ัะฐะฑะปะธัั: {e}")
            lines.append("")
        
        # ะัะธะผะตัะฐะฝะธั
        lines.append("ะัะธะผะตัะฐะฝะธั:")
        lines.append(f"  - ะจะฐะณ ะฟะพ ัะตะผะฟะตัะฐัััะต: {step_k} K")
        lines.append("  - ะัะต ะทะฝะฐัะตะฝะธั ัะฐัััะธัะฐะฝั ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ััะฐะฒะฝะตะฝะธะน ะจะพะผะตะนัะฐ")
        
        # ะัะตะดัะฟัะตะถะดะตะฝะธั ะพะฑ ะพะณัะฐะฝะธัะตะฝะธัั ะดะธะฐะฟะฐะทะพะฝะฐ
        if T_min < (record.Tmin or 0) or T_max > (record.Tmax or float('inf')):
            effective_T_min = max(T_min, record.Tmin or T_min)
            effective_T_max = min(T_max, record.Tmax or T_max)
            lines.append(f"  - โ๏ธ ะขะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ {T_min}-{T_max}K ะพะฑัะตะทะฐะฝ ะดะพ "
                        f"{effective_T_min}-{effective_T_max}K (ะฟัะตะดะตะปั ะฟัะธะผะตะฝะธะผะพััะธ ะดะฐะฝะฝัั)")
        
        return "\n".join(lines)
    
    def _format_basic_properties(self, record: DatabaseRecord) -> str:
        """
        ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะฑะฐะทะพะฒัั ัะฒะพะนััะฒ ะฒะตัะตััะฒะฐ.
        
        Args:
            record: ะะฐะฟะธัั ะธะท ะฑะฐะทั ะดะฐะฝะฝัั
        
        Returns:
            ะััะพัะผะฐัะธัะพะฒะฐะฝะฝะฐั ัััะพะบะฐ ั ะบะปัั-ะทะฝะฐัะตะฝะธะต ะฟะฐัะฐะผะธ
        """
        props = []
        
        # ะคะพัะผัะปะฐ ะธ ะฝะฐะทะฒะฐะฝะธะต
        props.append(f"  ะคะพัะผัะปะฐ: {record.Formula}")
        if record.Name:
            props.append(f"  ะะฐะทะฒะฐะฝะธะต: {record.Name}")
        
        # ะคะฐะทะฐ
        phase_map = {'s': 'solid', 'l': 'liquid', 'g': 'gas', 'aq': 'aqueous'}
        phase_desc = phase_map.get(record.Phase, record.Phase)
        props.append(f"  ะคะฐะทะฐ: {record.Phase} ({phase_desc})")
        
        # ะขะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ
        props.append(f"  T_ะดะธะฐะฟะฐะทะพะฝ: {record.Tmin or 'N/A'}-{record.Tmax or 'N/A'} K")
        
        # ะขะตะผะฟะตัะฐัััั ัะฐะทะพะฒัั ะฟะตัะตัะพะดะพะฒ
        if record.Tmelt:
            props.append(f"  Tmelt: {record.Tmelt} K")
        if record.Tboil:
            props.append(f"  Tboil: {record.Tboil} K")
        
        # ะกัะฐะฝะดะฐััะฝัะต ัะฒะพะนััะฒะฐ ะฟัะธ 298K
        if record.H298 is not None:
            props.append(f"  H298: {record.H298} ะบะะถ/ะผะพะปั")
        if record.S298 is not None:
            props.append(f"  S298: {record.S298} ะะถ/(ะผะพะปัยทK)")
        
        # ะะพัััะธัะธะตะฝัั Cp
        cp_coeffs = [
            f"f{i}={getattr(record, f'f{i}', 0) or 0:.3f}"
            for i in range(1, 7)
        ]
        props.append(f"  Cp_ะบะพัััะธัะธะตะฝัั: {', '.join(cp_coeffs)}")
        
        # ะะฐะดัะถะฝะพััั
        if record.Reliability:
            reliability_map = {'A': 'ะฒััะพะบะฐั', 'B': 'ััะตะดะฝัั', 'C': 'ะฝะธะทะบะฐั'}
            reliability_desc = reliability_map.get(record.Reliability, '')
            props.append(f"  ะะฐะดัะถะฝะพััั: {record.Reliability} ({reliability_desc})")
        
        return "\n".join(props)
    
    def _format_thermodynamic_table(self, table: ThermodynamicTable) -> str:
        """
        ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ัะฐะฑะปะธัั ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะธั ัะฒะพะนััะฒ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ tabulate.
        
        Args:
            table: ThermodynamicTable ั ัะฐัััะธัะฐะฝะฝัะผะธ ัะฒะพะนััะฒะฐะผะธ
        
        Returns:
            ะขะฐะฑะปะธัะฐ ะฒ ัะพัะผะฐัะต 'grid'
        """
        # ะะพะดะณะพัะพะฒะบะฐ ะดะฐะฝะฝัั ะดะปั tabulate
        headers = [
            "T(K)",
            "Cp\nะะถ/(ะผะพะปัยทK)",
            "H\nะบะะถ/ะผะพะปั",
            "S\nะะถ/(ะผะพะปัยทK)",
            "G\nะบะะถ/ะผะพะปั"
        ]
        
        table_data = []
        for prop in table.properties:
            row = [
                f"{prop.T:.0f}",
                f"{prop.Cp:.2f}",
                f"{prop.H / 1000:.2f}",  # ะะถ โ ะบะะถ
                f"{prop.S:.2f}",
                f"{prop.G / 1000:.2f}"   # ะะถ โ ะบะะถ
            ]
            table_data.append(row)
        
        return tabulate(table_data, headers=headers, tablefmt="grid")
    
    def _format_not_found_response(self, formula: str) -> str:
        """
        ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะพัะฒะตัะฐ ะดะปั ะฝะตะฝะฐะนะดะตะฝะฝะพะณะพ ะฒะตัะตััะฒะฐ.
        
        Args:
            formula: ะคะพัะผัะปะฐ ะฒะตัะตััะฒะฐ
        
        Returns:
            ะกะพะพะฑัะตะฝะธะต ะพะฑ ะพัะธะฑะบะต
        """
        return f"""
โ ะะตัะตััะฒะพ {formula} ะฝะต ะฝะฐะนะดะตะฝะพ ะฒ ะฑะฐะทะต ะดะฐะฝะฝัั

๐ก ะะพะทะผะพะถะฝัะต ะฟัะธัะธะฝั:
   - ะัะพะฒะตัััะต ะฟัะฐะฒะธะปัะฝะพััั ัะพัะผัะปั
   - ะะตัะตััะฒะพ ะผะพะถะตั ะพััััััะฒะพะฒะฐัั ะฒ ะฑะฐะทะต
   - ะะพะฟัะพะฑัะนัะต ะฐะปััะตัะฝะฐัะธะฒะฝะพะต ะฝะฐะทะฒะฐะฝะธะต ะธะปะธ ัะพัะผัะปั
"""


### 10.3. ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

**ะัะธะผะตั 1: ะฃัะฟะตัะฝัะน ะพัะฒะตั ะดะปั H2O**
```python
formatter = CompoundDataFormatter(calculator)

# result ัะพะดะตัะถะธั ะทะฐะฟะธัะธ ะดะปั H2O(g)
response = formatter.format_response(
    result=search_result_H2O,
    T_min=300,
    T_max=600,
    step_k=100
)

print(response)
```

**ะัะฒะพะด:**
```
๐ ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ะดะฐะฝะฝัะต: H2O

ะะฐะทะพะฒัะต ัะฒะพะนััะฒะฐ:
  ะคะพัะผัะปะฐ: H2O
  ะะฐะทะฒะฐะฝะธะต: Water
  ะคะฐะทะฐ: g (gas)
  T_ะดะธะฐะฟะฐะทะพะฝ: 298-1500 K
  Tmelt: 273.15 K
  Tboil: 373.15 K
  H298: -241.826 ะบะะถ/ะผะพะปั
  S298: 188.835 ะะถ/(ะผะพะปัยทK)
  Cp_ะบะพัััะธัะธะตะฝัั: f1=30.092, f2=6.832, f3=6.793, f4=-2.534, f5=0.082, f6=-0.000
  ะะฐะดัะถะฝะพััั: A (ะฒััะพะบะฐั)

ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ัะฒะพะนััะฒะฐ ะฟะพ ัะตะผะฟะตัะฐัััะต:
โโโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโโโโโโโ
โ T(K) โ  Cp        โ    H       โ    S       โ    G       โ
โ      โ ะะถ/(ะผะพะปัยทK)โ  ะบะะถ/ะผะพะปั  โ ะะถ/(ะผะพะปัยทK)โ  ะบะะถ/ะผะพะปั  โ
โโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโค
โ  300 โ   33.58    โ  -241.76   โ   189.04   โ  -298.47   โ
โ  400 โ   35.22    โ  -238.36   โ   198.79   โ  -317.88   โ
โ  500 โ   36.32    โ  -234.81   โ   206.53   โ  -338.08   โ
โ  600 โ   37.15    โ  -231.18   โ   213.05   โ  -359.01   โ
โโโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโโโโ

ะัะธะผะตัะฐะฝะธั:
  - ะจะฐะณ ะฟะพ ัะตะผะฟะตัะฐัััะต: 100 K
  - ะัะต ะทะฝะฐัะตะฝะธั ัะฐัััะธัะฐะฝั ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ััะฐะฒะฝะตะฝะธะน ะจะพะผะตะนัะฐ
```

**ะัะธะผะตั 2: ะะฐััะพะผะฝัะน ัะฐะณ 50K**
```python
response = formatter.format_response(
    result=search_result_WCl6,
    T_min=400,
    T_max=700,
    step_k=50
)
```

**ะัะฒะพะด:**
```
๐ ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ะดะฐะฝะฝัะต: WCl6

ะะฐะทะพะฒัะต ัะฒะพะนััะฒะฐ:
  ะคะพัะผัะปะฐ: WCl6
  ะะฐะทะฒะฐะฝะธะต: Tungsten hexachloride
  ะคะฐะทะฐ: g (gas)
  ...

ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ัะฒะพะนััะฒะฐ ะฟะพ ัะตะผะฟะตัะฐัััะต:
โโโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโโโโโโโ
โ T(K) โ  Cp        โ    H       โ    S       โ    G       โ
โโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโค
โ  400 โ   ...      โ  ...       โ   ...      โ  ...       โ
โ  450 โ   ...      โ  ...       โ   ...      โ  ...       โ
โ  500 โ   ...      โ  ...       โ   ...      โ  ...       โ
โ  550 โ   ...      โ  ...       โ   ...      โ  ...       โ
โ  600 โ   ...      โ  ...       โ   ...      โ  ...       โ
โ  650 โ   ...      โ  ...       โ   ...      โ  ...       โ
โ  700 โ   ...      โ  ...       โ   ...      โ  ...       โ
โโโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโโโโ

ะัะธะผะตัะฐะฝะธั:
  - ะจะฐะณ ะฟะพ ัะตะผะฟะตัะฐัััะต: 50 K
  - ะัะต ะทะฝะฐัะตะฝะธั ัะฐัััะธัะฐะฝั ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ััะฐะฒะฝะตะฝะธะน ะจะพะผะตะนัะฐ
```

### 10.4. ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

**ะะตัะตััะฒะพ ะฝะต ะฝะฐะนะดะตะฝะพ:**
```python
# ะัะปะธ CompoundSearcher ะฒะตัะฝัะป ะฟัััะพะน ัะฟะธัะพะบ
response = formatter.format_response(
    result=CompoundSearchResult(
        formula="UnknownCompound",
        records_found=[],
        filter_statistics=...
    ),
    T_min=300,
    T_max=600
)

# ะัะฒะพะด:
# โ ะะตัะตััะฒะพ UnknownCompound ะฝะต ะฝะฐะนะดะตะฝะพ ะฒ ะฑะฐะทะต ะดะฐะฝะฝัั
# ...
```

**ะขะตะผะฟะตัะฐัััะฐ ะฒะฝะต ะดะธะฐะฟะฐะทะพะฝะฐ:**
```python
# record.Tmin=400K, record.Tmax=1000K
# ะะฐะฟัะพั: T_min=300K, T_max=1200K

response = formatter.format_response(result, 300, 1200)

# ะ ะฟัะธะผะตัะฐะฝะธัั:
# โ๏ธ ะขะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ 300-1200K ะพะฑัะตะทะฐะฝ ะดะพ 400-1000K
#    (ะฟัะตะดะตะปั ะฟัะธะผะตะฝะธะผะพััะธ ะดะฐะฝะฝัั)
```

---

## 11. ะะตัะฐะปะธ ัะตะฐะปะธะทะฐัะธะธ: ReactionCalculationFormatter (ัะฐััั 1)

### 11.1. ะะฐะทะฝะฐัะตะฝะธะต ะธ ะฐััะธัะตะบัััะฐ

**ะะตััะพะฟะพะปะพะถะตะฝะธะต:** `src/thermo_agents/formatting/reaction_calculation_formatter.py` (ะฝะพะฒัะน ะผะพะดัะปั)

**ะฆะตะปั:** ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ ะดะปั ะทะฐะฟัะพัะพะฒ ัะธะฟะฐ `reaction_calculation` โ ะฒัะฒะพะด ะผะตัะพะดะฐ ัะฐััััะฐ, ะดะฐะฝะฝัั ะฒะตัะตััะฒ ะธ ัะตะทัะปััะฐัะพะฒ ัะตัะผะพะดะธะฝะฐะผะธัะตัะบะพะณะพ ะฐะฝะฐะปะธะทะฐ ัะตะฐะบัะธะธ.

### 11.2. ะกัััะบัััะฐ ะฒัะฒะพะดะฐ

```
โ๏ธ ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะน ัะฐัััั ัะตะฐะบัะธะธ

ะฃัะฐะฒะฝะตะฝะธะต: 2 W(s) + 4 Clโ(g) + Oโ(g) โ 2 WOClโ(g)
ะขะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ: 600-900 K

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะะตัะพะด ัะฐััััะฐ:
[ะคะพัะผัะปั ะธ ะพะฟะธัะฐะฝะธะต]

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ะดะฐะฝะฝัะต ะฒะตัะตััะฒ:
[ะะพะผะฟะฐะบัะฝัะต ัะฐะฑะปะธัั ะดะปั ะบะฐะถะดะพะณะพ ะฒะตัะตััะฒะฐ]

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะะตะทัะปััะฐัั ัะฐััััะฐ:
[ะขะตะผะฟะตัะฐัััะฐ: ฮH, ฮS, ฮG]

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ ะะฐะบะปััะตะฝะธะต
```

### 11.3. API ะบะปะฐััะฐ ReactionCalculationFormatter

```python
from typing import List, Dict, Tuple
from src.thermo_agents.models.search import DatabaseRecord, CompoundSearchResult
from src.thermo_agents.models.extraction import ExtractedReactionParameters
from src.thermo_agents.calculations.thermodynamic_calculator import ThermodynamicCalculator


class ReactionCalculationFormatter:
    """
    ะคะพัะผะฐััะตั ะดะปั ะฒัะฒะพะดะฐ ัะฐััััะพะฒ ัะตัะผะพะดะธะฝะฐะผะธะบะธ ัะตะฐะบัะธะน.
    
    ะะตะฝะตัะธััะตั:
    - ะะฟะธัะฐะฝะธะต ะผะตัะพะดะฐ ัะฐััััะฐ ั ะผะฐัะตะผะฐัะธัะตัะบะธะผะธ ัะพัะผัะปะฐะผะธ
    - ะะพะผะฟะฐะบัะฝัะต ะดะฐะฝะฝัะต ะฟะพ ะฒะตัะตััะฒะฐะผ ัะตะฐะบัะธะธ
    - ะะตะทัะปััะฐัั ัะฐััััะฐ ฮH, ฮS, ฮG ะฟะพ ัะตะผะฟะตัะฐัััะฐะผ
    """
    
    def __init__(self, calculator: ThermodynamicCalculator):
        """
        ะะฝะธัะธะฐะปะธะทะฐัะธั ัะพัะผะฐััะตัะฐ.
        
        Args:
            calculator: ะญะบะทะตะผะฟะปัั ThermodynamicCalculator ะดะปั ัะฐััััะพะฒ
        """
        self.calculator = calculator
    
    def format_response(
        self,
        params: ExtractedReactionParameters,
        reactants: List[CompoundSearchResult],
        products: List[CompoundSearchResult],
        step_k: int = 100
    ) -> str:
        """
        ะะตะฝะตัะฐัะธั ะฟะพะปะฝะพะณะพ ะพัะฒะตัะฐ ะดะปั ัะฐััััะฐ ัะตะฐะบัะธะธ.
        
        Args:
            params: ะะฐัะฐะผะตััั ัะตะฐะบัะธะธ (ััะฐะฒะฝะตะฝะธะต, ัะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ)
            reactants: ะกะฟะธัะพะบ ัะตะทัะปััะฐัะพะฒ ะฟะพะธัะบะฐ ัะตะฐะณะตะฝัะพะฒ
            products: ะกะฟะธัะพะบ ัะตะทัะปััะฐัะพะฒ ะฟะพะธัะบะฐ ะฟัะพะดัะบัะพะฒ
            step_k: ะจะฐะณ ัะตะผะฟะตัะฐัััั, K
        
        Returns:
            ะััะพัะผะฐัะธัะพะฒะฐะฝะฝัะน ัะตะบััะพะฒัะน ะพัะฒะตั
        """
        lines = []
        
        # ะะฐะณะพะปะพะฒะพะบ
        lines.append("โ๏ธ ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะน ัะฐัััั ัะตะฐะบัะธะธ")
        lines.append("")
        
        # ะฃัะฐะฒะฝะตะฝะธะต ัะตะฐะบัะธะธ (ั Unicode ัะธะผะฒะพะปะฐะผะธ)
        equation = self._format_equation(params.balanced_equation)
        lines.append(f"ะฃัะฐะฒะฝะตะฝะธะต: {equation}")
        T_min, T_max = params.temperature_range_k
        lines.append(f"ะขะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ: {T_min:.0f}-{T_max:.0f} K")
        lines.append("")
        
        # ะะฐะทะดะตะปะธัะตะปั
        lines.append("โ" * 60)
        lines.append("")
        
        # ะะตัะพะด ัะฐััััะฐ
        lines.append(self._format_calculation_method())
        lines.append("")
        
        # ะะฐะทะดะตะปะธัะตะปั
        lines.append("โ" * 60)
        lines.append("")
        
        # ะะฐะฝะฝัะต ะฒะตัะตััะฒ
        lines.append("ะขะตัะผะพะดะธะฝะฐะผะธัะตัะบะธะต ะดะฐะฝะฝัะต ะฒะตัะตััะฒ:")
        lines.append("")
        lines.append(self._format_substances_data(reactants, products))
        lines.append("")
        
        # ะะฐะทะดะตะปะธัะตะปั
        lines.append("โ" * 60)
        lines.append("")
        
        # ะะตะทัะปััะฐัั ัะฐััััะฐ (ะฑัะดะตั ะดะพะฑะฐะฒะปะตะฝะพ ะฒ ัะฐััะธ 2)
        lines.append("ะะตะทัะปััะฐัั ัะฐััััะฐ (ะฝะฐ ะผะพะปั ะฟัะพะดัะบัะฐ):")
        lines.append("")
        # [TODO: ะดะพะฑะฐะฒะธัั ัะตะทัะปััะฐัั ะฒ ัะฐััะธ 2]
        
        return "\n".join(lines)
    
    def _format_equation(self, equation: str) -> str:
        """
        ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ััะฐะฒะฝะตะฝะธั ัะตะฐะบัะธะธ ั Unicode ัะธะผะฒะพะปะฐะผะธ.
        
        ะะฐะผะตะฝั:
        - -> โ โ
        - (s) โ (s) (ัะฒััะดะพะต)
        - (g) โ (g) (ะณะฐะท)
        - (l) โ (l) (ะถะธะดะบะพััั)
        - ะะพะดัััะพัะฝัะต ะธะฝะดะตะบัั: H2O โ HโO, CO2 โ COโ
        
        Args:
            equation: ะฃัะฐะฒะฝะตะฝะธะต ะฒ ัะตะบััะพะฒะพะผ ัะพัะผะฐัะต
        
        Returns:
            ะฃัะฐะฒะฝะตะฝะธะต ั Unicode ัะพัะผะฐัะธัะพะฒะฐะฝะธะตะผ
        """
        # ะะฐะผะตะฝะฐ ัััะตะปะพะบ
        formatted = equation.replace("->", "โ").replace("=", "โ").replace("<=>", "โ")
        
        # ะะฐะผะตะฝะฐ ะฟะพะดัััะพัะฝัั ะธะฝะดะตะบัะพะฒ (ัะฟัะพััะฝะฝะฐั ะฒะตััะธั)
        subscript_map = {
            '0': 'โ', '1': 'โ', '2': 'โ', '3': 'โ', '4': 'โ',
            '5': 'โ', '6': 'โ', '7': 'โ', '8': 'โ', '9': 'โ'
        }
        
        # ะัะพััะพะต ะฟัะฐะฒะธะปะพ: ัะธััั ะฟะพัะปะต ะฑัะบะฒ โ ะฟะพะดัััะพัะฝัะต
        result = []
        prev_char = ''
        for char in formatted:
            if char.isdigit() and (prev_char.isalpha() or prev_char == ')'):
                result.append(subscript_map.get(char, char))
            else:
                result.append(char)
            prev_char = char
        
        return ''.join(result)
    
    def _format_calculation_method(self) -> str:
        """
        ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะพะฟะธัะฐะฝะธั ะผะตัะพะดะฐ ัะฐััััะฐ ั ะผะฐัะตะผะฐัะธัะตัะบะธะผะธ ัะพัะผัะปะฐะผะธ.
        
        Returns:
            ะขะตะบัั ั ะพะฟะธัะฐะฝะธะตะผ ะผะตัะพะดะฐ ะธ ัะพัะผัะปะฐะผะธ ะฒ Unicode
        """
        return """ะะตัะพะด ัะฐััััะฐ:

1. ะญะฝัะฐะปัะฟะธั ัะตะฐะบัะธะธ: ฮHยฐ(T) = ฮฃHยฐ_ะฟัะพะดัะบัั - ฮฃHยฐ_ัะตะฐะณะตะฝัั
2. ะญะฝััะพะฟะธั ัะตะฐะบัะธะธ: ฮSยฐ(T) = ฮฃSยฐ_ะฟัะพะดัะบัั - ฮฃSยฐ_ัะตะฐะณะตะฝัั  
3. ะญะฝะตัะณะธั ะะธะฑะฑัะฐ: ฮGยฐ(T) = ฮHยฐ(T) - TยทฮSยฐ(T)

ะะดะต:
  Hยฐ(T) = Hยฐโโโ + โซโโโแต Cp(T)dT
  Sยฐ(T) = Sยฐโโโ + โซโโโแต [Cp(T)/T]dT
  Cp(T) = fโ + fโT/1000 + fโTโปยฒยท10โต + fโTยฒ/10โถ + fโTโปยณยท10ยณ + fโTยณยท10โปโน"""
    
    def _format_substances_data(
        self,
        reactants: List[CompoundSearchResult],
        products: List[CompoundSearchResult]
    ) -> str:
        """
        ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะบะพะผะฟะฐะบัะฝัั ะดะฐะฝะฝัั ะฟะพ ะฒะตัะตััะฒะฐะผ ัะตะฐะบัะธะธ.
        
        Args:
            reactants: ะะตะทัะปััะฐัั ะฟะพะธัะบะฐ ัะตะฐะณะตะฝัะพะฒ
            products: ะะตะทัะปััะฐัั ะฟะพะธัะบะฐ ะฟัะพะดัะบัะพะฒ
        
        Returns:
            ะะพะผะฟะฐะบัะฝะพะต ะฟัะตะดััะฐะฒะปะตะฝะธะต ะดะฐะฝะฝัั ะฒะตัะตััะฒ
        """
        lines = []
        
        # ะกะฝะฐัะฐะปะฐ ัะตะฐะณะตะฝัั, ะฟะพัะพะผ ะฟัะพะดัะบัั
        all_compounds = reactants + products
        
        for result in all_compounds:
            if not result.records_found:
                lines.append(f"{result.formula} โ โ ะะ ะะะะะะะ")
                lines.append("")
                continue
            
            record = result.records_found[0]
            
            # ะะฐะทะฒะฐะฝะธะต ะฒะตัะตััะฒะฐ
            name = record.Name or "Unknown"
            lines.append(f"{record.Formula} โ {name}")
            
            # ะคะฐะทะฐ ะธ ัะตะผะฟะตัะฐัััะฝัะน ะดะธะฐะฟะฐะทะพะฝ (ะฒ ะพะดะฝะพะน ัััะพะบะต)
            phase_map = {'s': 'solid', 'l': 'liquid', 'g': 'gas', 'aq': 'aqueous'}
            phase_desc = phase_map.get(record.Phase, record.Phase)
            lines.append(f"  ะคะฐะทะฐ: {record.Phase} | T_ะฟัะธะผะตะฝะธะผะพััะธ: {record.Tmin or 'N/A'}-{record.Tmax or 'N/A'} K")
            
            # H298 ะธ S298 (ะฒ ะพะดะฝะพะน ัััะพะบะต)
            H298_str = f"{record.H298}" if record.H298 is not None else "N/A"
            S298_str = f"{record.S298}" if record.S298 is not None else "N/A"
            lines.append(f"  H298: {H298_str} ะบะะถ/ะผะพะปั | S298: {S298_str} ะะถ/(ะผะพะปัยทK)")
            
            # ะะพัััะธัะธะตะฝัั Cp (ะฒ ะพะดะฝะพะน ัััะพะบะต, ะบะพะผะฟะฐะบัะฝะพ)
            cp_coeffs = [
                f"{getattr(record, f'f{i}', 0) or 0:.3f}"
                for i in range(1, 7)
            ]
            lines.append(f"  Cp: [{', '.join(cp_coeffs)}]")
            
            lines.append("")
        
        return "\n".join(lines)


### 11.4. ะัะธะผะตัั ัะพัะผะฐัะธัะพะฒะฐะฝะธั

**ะัะธะผะตั 1: ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ััะฐะฒะฝะตะฝะธั**
```python
formatter = ReactionCalculationFormatter(calculator)

# ะัะพะดะฝะพะต ััะฐะฒะฝะตะฝะธะต
equation = "2 W(s) + 4 Cl2(g) + O2(g) -> 2 WOCl4(g)"

# ะคะพัะผะฐัะธัะพะฒะฐะฝะฝะพะต
formatted = formatter._format_equation(equation)
print(formatted)
# ะัะฒะพะด: "2 W(s) + 4 Clโ(g) + Oโ(g) โ 2 WOClโ(g)"
```

**ะัะธะผะตั 2: ะะตัะพะด ัะฐััััะฐ**
```python
method_text = formatter._format_calculation_method()
print(method_text)
```

**ะัะฒะพะด:**
```
ะะตัะพะด ัะฐััััะฐ:

1. ะญะฝัะฐะปัะฟะธั ัะตะฐะบัะธะธ: ฮHยฐ(T) = ฮฃHยฐ_ะฟัะพะดัะบัั - ฮฃHยฐ_ัะตะฐะณะตะฝัั
2. ะญะฝััะพะฟะธั ัะตะฐะบัะธะธ: ฮSยฐ(T) = ฮฃSยฐ_ะฟัะพะดัะบัั - ฮฃSยฐ_ัะตะฐะณะตะฝัั  
3. ะญะฝะตัะณะธั ะะธะฑะฑัะฐ: ฮGยฐ(T) = ฮHยฐ(T) - TยทฮSยฐ(T)

ะะดะต:
  Hยฐ(T) = Hยฐโโโ + โซโโโแต Cp(T)dT
  Sยฐ(T) = Sยฐโโโ + โซโโโแต [Cp(T)/T]dT
  Cp(T) = fโ + fโT/1000 + fโTโปยฒยท10โต + fโTยฒ/10โถ + fโTโปยณยท10ยณ + fโTยณยท10โปโน
```

**ะัะธะผะตั 3: ะะฐะฝะฝัะต ะฒะตัะตััะฒ (ะบะพะผะฟะฐะบัะฝัะน ัะพัะผะฐั)**
```python
substances_text = formatter._format_substances_data(reactants, products)
print(substances_text)
```

**ะัะฒะพะด:**
```
W โ Tungsten
  ะคะฐะทะฐ: s | T_ะฟัะธะผะตะฝะธะผะพััะธ: 450-2500 K
  H298: 0.0 ะบะะถ/ะผะพะปั | S298: 32.64 ะะถ/(ะผะพะปัยทK)
  Cp: [23.957, 3.868, 0.000, -0.761, 0.000, 0.000]

Clโ โ Chlorine  
  ะคะฐะทะฐ: g | T_ะฟัะธะผะตะฝะธะผะพััะธ: 298-1500 K
  H298: 0.0 ะบะะถ/ะผะพะปั | S298: 223.08 ะะถ/(ะผะพะปัยทK)
  Cp: [33.907, 0.892, -7.615, 0.229, 0.023, 0.000]

Oโ โ Oxygen
  ะคะฐะทะฐ: g | T_ะฟัะธะผะตะฝะธะผะพััะธ: 298-700 K
  H298: 0.0 ะบะะถ/ะผะพะปั | S298: 205.15 ะะถ/(ะผะพะปัยทK)
  Cp: [29.659, 6.137, -11.881, 0.794, 0.674, 0.000]

WOClโ โ Tungsten oxychloride
  ะคะฐะทะฐ: g | T_ะฟัะธะผะตะฝะธะผะพััะธ: 298-600 K
  H298: -681.6 ะบะะถ/ะผะพะปั | S298: 378.2 ะะถ/(ะผะพะปัยทK)
  Cp: [87.445, 13.821, 0.000, -2.156, 0.000, 0.000]
```

### 11.5. Unicode ัะธะผะฒะพะปั ะดะปั ัะพัะผัะป

**ะัะฟะพะปัะทัะตะผัะต ัะธะผะฒะพะปั:**

| ะกะธะผะฒะพะป     | Unicode        | ะัะฟะพะปัะทะพะฒะฐะฝะธะต       |
| ---------- | -------------- | ------------------- |
| โ          | U+2192         | ะกััะตะปะบะฐ ัะตะฐะบัะธะธ     |
| โ          | U+21C4         | ะะฑัะฐัะธะผะฐั ัะตะฐะบัะธั   |
| ฮ          | U+0394         | ะะทะผะตะฝะตะฝะธะต (ะดะตะปััะฐ)  |
| ยฐ          | U+00B0         | ะกัะฐะฝะดะฐััะฝัะต ััะปะพะฒะธั |
| โซ          | U+222B         | ะะฝัะตะณัะฐะป            |
| โโโโโโโโโโ | U+2080-2089    | ะะพะดัััะพัะฝัะต ะธะฝะดะตะบัั |
| โป          | U+207B         | ะะฐะดัััะพัะฝัะน ะผะธะฝัั   |
| ยฒ ยณ        | U+00B2, U+00B3 | ะะฐะดัััะพัะฝัะต ััะตะฟะตะฝะธ |

**ะะปััะตัะฝะฐัะธะฒะฐ (LaTeX ะดะปั ะดะพะบัะผะตะฝัะฐัะธะธ):**
```latex
\Delta Hยฐ(T) = \sum Hยฐ_{\text{ะฟัะพะดัะบัั}} - \sum Hยฐ_{\text{ัะตะฐะณะตะฝัั}}
Hยฐ(T) = Hยฐ_{298} + \int_{298}^{T} C_p(T)dT
C_p(T) = f_1 + f_2\frac{T}{1000} + f_3T^{-2} \cdot 10^5 + ...
```

---
